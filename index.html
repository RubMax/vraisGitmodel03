<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accueil</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <div id="headerOverlay" class="header-overlay">
      <img id="logo" class="logo" src="" alt="Logo">
      <div class="header-center">
        <h1 id="nomEntreprise"></h1>
        <p id="slogant"></p>
      </div>
    </div>
  </header>

  <nav class="sidebar" id="sidebarMenu">
    <a href="javascript:void(0)" class="active" onclick="filtrerParType('tous')">Menu</a>
  </nav>

  <div class="content-container">
    <div id="servicesContainer"></div>
    <footer>
      <p><span id="adresse"></span></p>
      <p>Tél: <span id="telfix"></span> | WhatsApp: <span id="whatsapp"></span></p>
      <p>Email: <span id="email"></span></p>
      <p>Domaine: <span id="domaine"></span></p>
    </footer>
  </div>

  <script>
    let allServicesData = [];
    let groupedServices = {};
    let whatsappNumber = "";
    const colors = ["#e74c3c", "#8e44ad", "#3498db", "#16a085", "#f39c12", "#d35400", "#2c3e50"];

    document.addEventListener("DOMContentLoaded", function () {
      fetch("data.json")
        .then(res => res.json())
        .then(data => renderPage(data))
        .catch(err => console.error("Erreur de chargement des données:", err));
    });

    function renderPage(data) {
      allServicesData = data.services;
      whatsappNumber = data.entete.whatsapp;

      document.getElementById("nomEntreprise").innerText = data.entete.nomEntreprise;
      document.getElementById("logo").src = data.entete.imgLogo;
      document.getElementById("slogant").innerText = data.entete.slogant;
      document.getElementById("headerOverlay").style.backgroundImage = `url('${data.entete.imgEntete}')`;
      document.getElementById("adresse").innerText = data.entete.adresse;
      document.getElementById("telfix").innerText = data.entete.telFix;
      document.getElementById("whatsapp").innerText = data.entete.whatsapp;
      document.getElementById("email").innerText = data.entete.email;
      document.getElementById("domaine").innerText = data.entete.domaine;

      groupedServices = {};
      const sidebarMenu = document.getElementById("sidebarMenu");
      const typesAjoutes = new Set();

      let colorIndex = 0;

      data.services.forEach(service => {
        if (!groupedServices[service.type]) groupedServices[service.type] = [];
        groupedServices[service.type].push(service);

        if (!typesAjoutes.has(service.type)) {
          const link = document.createElement("a");
          link.href = "javascript:void(0)";
          link.textContent = service.type;
          link.style.backgroundColor = colors[colorIndex % colors.length];
          link.dataset.originalColor = colors[colorIndex % colors.length];
          link.addEventListener("click", (e) => {
            e.preventDefault();
            filtrerParType(service.type);
          });
          sidebarMenu.appendChild(link);
          typesAjoutes.add(service.type);
          colorIndex++;
        }
      });

      afficherArticles(data.services, "Menu");
    }

    function afficherArticles(liste, titre) {
      const container = document.getElementById("servicesContainer");
      container.innerHTML = "";

      const sectionTitle = document.createElement("div");
      sectionTitle.className = "section-title";
      sectionTitle.textContent = titre;
      container.appendChild(sectionTitle);

      const cards = document.createElement("div");
      cards.className = "cards-container";

      liste.forEach(service => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerHTML = `
          <img src="${service.img}" alt="${service.nom}">
          <div class="card-body">
            <div class="card-title">${service.nom}</div>
            <div class="card-desc">${service.description}</div>
            <div class="card-price">R$ ${service.prix}</div>
          </div>
        `;
        cards.appendChild(card);
      });

      container.appendChild(cards);
    }

    function filtrerParType(type) {
      const links = document.querySelectorAll("#sidebarMenu a");
      links.forEach(link => {
        link.classList.remove("active");
        link.style.backgroundColor = link.dataset.originalColor;
        link.style.color = "white";
        if (link.textContent === type || (type === 'tous' && link.textContent === 'Menu')) {
          link.classList.add("active");
          link.style.backgroundColor = "white";
          link.style.color = "black";
        }
      });

      if (type === 'tous') {
        afficherArticles(allServicesData, "Menu");
      } else {
        afficherArticles(groupedServices[type] || [], type);
      }
    }
  </script>
</body>
</html>
